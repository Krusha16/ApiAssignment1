"use strict";function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var streets=document.querySelector(".streets"),tbody=document.querySelector("tbody"),streetName=document.getElementById("street-name"),input=document.querySelector(".input");function getStreets(e){return fetch("https://api.winnipegtransit.com/v3/streets.json?api-key=qhJFl4WLev9xuoa7gwJK&name=".concat(e)).then((function(e){return e.json()}))}function getStops(e){return fetch("https://api.winnipegtransit.com/v3/stops.json?api-key=qhJFl4WLev9xuoa7gwJK&street=".concat(e)).then((function(e){return e.json()}))}function getStopSchedule(e){return fetch("https://api.winnipegtransit.com/v3/stops/".concat(e,"/schedule.json?api-key=qhJFl4WLev9xuoa7gwJK&max-results-per-route=2")).then((function(e){return e.json()}))}function search(e){"Enter"===e.key&&(e.preventDefault(),""!==input.value&&(streets.innerHTML="",getStreets(input.value).then((function(e){if(0===e.streets.length)streets.insertAdjacentHTML("beforeend","No Streets found");else{var t,n=_createForOfIteratorHelper(e.streets);try{for(n.s();!(t=n.n()).done;){insertHTMLForStreets(t.value)}}catch(e){n.e(e)}finally{n.f()}handleClickOnEachStreet()}})),input.value=""))}function insertHTMLForStreets(e){streets.insertAdjacentHTML("beforeend",'<a href="#" datakey='.concat(e.key,">\n      ").concat(e.name,"\n    </a>"))}function handleClickOnEachStreet(){document.querySelectorAll("a").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),tbody.innerHTML="",streetName.innerHTML="",getStopsForEachStreet(e.target.getAttribute("datakey"))}))})),tbody.innerHTML=""}function getStopsForEachStreet(e){getStops(e).then((function(e){findNext2BusesForEachRoute(e.stops.map((function(e){return getStopSchedule(e.key)})))}))}function findNext2BusesForEachRoute(e){Promise.all(e).then((function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var r,o=t.value,a=_createForOfIteratorHelper(o["stop-schedule"]["route-schedules"]);try{var c=function(){var e=r.value,t=o["stop-schedule"].stop.street.name,n=o["stop-schedule"].stop["cross-street"].name,a=o["stop-schedule"].stop.direction,c=e.route.number;streetName.innerHTML="Displaying results for ".concat(t),e["scheduled-stops"].forEach((function(e){var r=new Date(e.times.arrival.estimated).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});insertHTMLForEachStops(t,a,n,c,r)}))};for(a.s();!(r=a.n()).done;)c()}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}}))}function insertHTMLForEachStops(e,t,n,r,o){tbody.insertAdjacentHTML("beforeend","<tr>\n  <td>".concat(e,"</td>\n  <td>").concat(n,"</td>\n  <td>").concat(t,"</td>\n  <td>").concat(r,"</td>\n  <td>").concat(o,"</td>\n  </tr>\n  "))}input.addEventListener("keypress",search);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsIm8iLCJhbGxvd0FycmF5TGlrZSIsIml0IiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJBcnJheSIsImlzQXJyYXkiLCJfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkiLCJsZW5ndGgiLCJpIiwiRiIsInMiLCJuIiwiZG9uZSIsInZhbHVlIiwiZSIsIl9lIiwiZiIsIlR5cGVFcnJvciIsImVyciIsIm5vcm1hbENvbXBsZXRpb24iLCJkaWRFcnIiLCJzdGVwIiwibmV4dCIsIl9lMiIsIm1pbkxlbiIsIl9hcnJheUxpa2VUb0FycmF5IiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwic2xpY2UiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJmcm9tIiwidGVzdCIsImFyciIsImxlbiIsImFycjIiLCJzdHJlZXRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGJvZHkiLCJzdHJlZXROYW1lIiwiZ2V0RWxlbWVudEJ5SWQiLCJpbnB1dCIsImdldFN0cmVldHMiLCJpbnB1dFN0cmluZyIsImZldGNoIiwiY29uY2F0IiwidGhlbiIsIlJlc3BvbnNlIiwianNvbiIsImdldFN0b3BzIiwia2V5IiwiZ2V0U3RvcFNjaGVkdWxlIiwic2VhcmNoIiwicHJldmVudERlZmF1bHQiLCJpbm5lckhUTUwiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJfc3RlcCIsIl9pdGVyYXRvciIsImluc2VydEhUTUxGb3JTdHJlZXRzIiwiaGFuZGxlQ2xpY2tPbkVhY2hTdHJlZXQiLCJzdHJlZXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0U3RvcHNGb3JFYWNoU3RyZWV0IiwidGFyZ2V0IiwiZ2V0QXR0cmlidXRlIiwic3RvcHMiLCJmaW5kTmV4dDJCdXNlc0ZvckVhY2hSb3V0ZSIsIm1hcCIsInN0b3BTY2hlZHVsZSIsIlByb21pc2UiLCJhbGwiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwiX3N0ZXAzIiwic2VsZWN0ZWRSb3V0ZSIsIl9pdGVyYXRvcjMiLCJfbG9vcCIsInJvdXRlcyIsInN0b3BOYW1lIiwic3RvcCIsImNyb3NzU3RyZWV0IiwiZGlyZWN0aW9uIiwiYnVzTnVtYmVyIiwicm91dGUiLCJudW1iZXIiLCJ0aW1lIiwiRGF0ZSIsInRpbWVzIiwiYXJyaXZhbCIsImVzdGltYXRlZCIsInRvTG9jYWxlU3RyaW5nIiwiaG91ciIsIm1pbnV0ZSIsImhvdXIxMiIsImluc2VydEhUTUxGb3JFYWNoU3RvcHMiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsU0FBU0EsMkJBQTJCQyxFQUFHQyxHQUFrQixJQUFJQyxFQUFJLEdBQXNCLG9CQUFYQyxRQUFnRCxNQUF0QkgsRUFBRUcsT0FBT0MsVUFBbUIsQ0FBRSxHQUFJQyxNQUFNQyxRQUFRTixLQUFPRSxFQUFLSyw0QkFBNEJQLEtBQU9DLEdBQWtCRCxHQUF5QixpQkFBYkEsRUFBRVEsT0FBcUIsQ0FBTU4sSUFBSUYsRUFBSUUsR0FBSSxJQUFJTyxFQUFJLEVBQU9DLEVBQUksYUFBaUIsTUFBTyxDQUFFQyxFQUFHRCxFQUFHRSxFQUFHLFdBQWUsT0FBSUgsR0FBS1QsRUFBRVEsT0FBZSxDQUFFSyxNQUFNLEdBQWUsQ0FBRUEsTUFBTSxFQUFPQyxNQUFPZCxFQUFFUyxPQUFXTSxFQUFHLFNBQVdDLEdBQU0sTUFBTUEsR0FBT0MsRUFBR1AsR0FBTyxNQUFNLElBQUlRLFVBQVUseUlBQTRJLElBQTZDQyxFQUF6Q0MsR0FBbUIsRUFBTUMsR0FBUyxFQUFZLE1BQU8sQ0FBRVYsRUFBRyxXQUFlVCxFQUFLRixFQUFFRyxPQUFPQyxhQUFnQlEsRUFBRyxXQUFlLElBQUlVLEVBQU9wQixFQUFHcUIsT0FBc0MsT0FBOUJILEVBQW1CRSxFQUFLVCxLQUFhUyxHQUFTUCxFQUFHLFNBQVdTLEdBQU9ILEdBQVMsRUFBTUYsRUFBTUssR0FBUVAsRUFBRyxXQUFlLElBQVdHLEdBQW9DLE1BQWhC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Q29udGVudCI6WyJjb25zdCBzdHJlZXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0cmVldHMnKTtcclxuY29uc3QgdGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0Ym9keScpO1xyXG5jb25zdCBzdHJlZXROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0cmVldC1uYW1lJyk7XHJcbmNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmlucHV0Jyk7XHJcbmlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgc2VhcmNoKTtcclxuXHJcbmZ1bmN0aW9uIGdldFN0cmVldHMoaW5wdXRTdHJpbmcpIHtcclxuICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vYXBpLndpbm5pcGVndHJhbnNpdC5jb20vdjMvc3RyZWV0cy5qc29uP2FwaS1rZXk9cWhKRmw0V0xldjl4dW9hN2d3SksmbmFtZT0ke2lucHV0U3RyaW5nfWApXHJcbiAgICAudGhlbihSZXNwb25zZSA9PiB7XHJcbiAgICAgIHJldHVybiBSZXNwb25zZS5qc29uKCk7XHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRTdG9wcyhrZXkpIHtcclxuICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vYXBpLndpbm5pcGVndHJhbnNpdC5jb20vdjMvc3RvcHMuanNvbj9hcGkta2V5PXFoSkZsNFdMZXY5eHVvYTdnd0pLJnN0cmVldD0ke2tleX1gKVxyXG4gICAgLnRoZW4oUmVzcG9uc2UgPT4ge1xyXG4gICAgICByZXR1cm4gUmVzcG9uc2UuanNvbigpO1xyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U3RvcFNjaGVkdWxlKGtleSkge1xyXG4gIHJldHVybiBmZXRjaChgaHR0cHM6Ly9hcGkud2lubmlwZWd0cmFuc2l0LmNvbS92My9zdG9wcy8ke2tleX0vc2NoZWR1bGUuanNvbj9hcGkta2V5PXFoSkZsNFdMZXY5eHVvYTdnd0pLJm1heC1yZXN1bHRzLXBlci1yb3V0ZT0yYClcclxuICAgIC50aGVuKFJlc3BvbnNlID0+IHtcclxuICAgICAgcmV0dXJuIFJlc3BvbnNlLmpzb24oKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlYXJjaChlKSB7XHJcbiAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoaW5wdXQudmFsdWUgIT09ICcnKSB7XHJcbiAgICAgIHN0cmVldHMuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgZ2V0U3RyZWV0cyhpbnB1dC52YWx1ZSlcclxuICAgICAgICAudGhlbihqc29uID0+IHtcclxuICAgICAgICAgIGlmIChqc29uLnN0cmVldHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHN0cmVldHMuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLFxyXG4gICAgICAgICAgICAgIGBObyBTdHJlZXRzIGZvdW5kYClcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc3RyZWV0IG9mIGpzb24uc3RyZWV0cykge1xyXG4gICAgICAgICAgICAgIGluc2VydEhUTUxGb3JTdHJlZXRzKHN0cmVldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaGFuZGxlQ2xpY2tPbkVhY2hTdHJlZXQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICBpbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuZnVuY3Rpb24gaW5zZXJ0SFRNTEZvclN0cmVldHMoc3RyZWV0KSB7XHJcbiAgc3RyZWV0cy5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsXHJcbiAgICBgPGEgaHJlZj1cIiNcIiBkYXRha2V5PSR7c3RyZWV0LmtleX0+XHJcbiAgICAgICR7c3RyZWV0Lm5hbWV9XHJcbiAgICA8L2E+YClcclxufTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNsaWNrT25FYWNoU3RyZWV0KCkge1xyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGJvZHkuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgc3RyZWV0TmFtZS5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICBsZXQga2V5ID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRha2V5Jyk7XHJcbiAgICAgIGdldFN0b3BzRm9yRWFjaFN0cmVldChrZXkpO1xyXG4gICAgfSlcclxuICB9KVxyXG4gIHRib2R5LmlubmVySFRNTCA9IFwiXCI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFN0b3BzRm9yRWFjaFN0cmVldChrZXkpIHtcclxuICBnZXRTdG9wcyhrZXkpXHJcbiAgICAudGhlbigoc3RvcHMpID0+IHtcclxuICAgICAgbGV0IHN0b3BTY2hlZHVsZSA9IHN0b3BzLnN0b3BzLm1hcChmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIGxldCBzY2hlZHVsZSA9IGdldFN0b3BTY2hlZHVsZShuYW1lLmtleSk7XHJcbiAgICAgICAgcmV0dXJuIHNjaGVkdWxlO1xyXG4gICAgICB9KVxyXG4gICAgICBmaW5kTmV4dDJCdXNlc0ZvckVhY2hSb3V0ZShzdG9wU2NoZWR1bGUpO1xyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gZmluZE5leHQyQnVzZXNGb3JFYWNoUm91dGUoc3RvcFNjaGVkdWxlKSB7XHJcbiAgUHJvbWlzZS5hbGwoc3RvcFNjaGVkdWxlKVxyXG4gICAgLnRoZW4oKHN0b3BTY2hlZHVsZSkgPT4ge1xyXG4gICAgICBmb3IgKGNvbnN0IHNlbGVjdGVkUm91dGUgb2Ygc3RvcFNjaGVkdWxlKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCByb3V0ZXMgb2Ygc2VsZWN0ZWRSb3V0ZVsnc3RvcC1zY2hlZHVsZSddWydyb3V0ZS1zY2hlZHVsZXMnXSkge1xyXG4gICAgICAgICAgbGV0IHN0b3BOYW1lID0gc2VsZWN0ZWRSb3V0ZVsnc3RvcC1zY2hlZHVsZSddLnN0b3Auc3RyZWV0Lm5hbWU7XHJcbiAgICAgICAgICBsZXQgY3Jvc3NTdHJlZXQgPSBzZWxlY3RlZFJvdXRlWydzdG9wLXNjaGVkdWxlJ10uc3RvcFsnY3Jvc3Mtc3RyZWV0J10ubmFtZTtcclxuICAgICAgICAgIGxldCBkaXJlY3Rpb24gPSBzZWxlY3RlZFJvdXRlWydzdG9wLXNjaGVkdWxlJ10uc3RvcC5kaXJlY3Rpb247XHJcbiAgICAgICAgICBsZXQgYnVzTnVtYmVyID0gcm91dGVzLnJvdXRlLm51bWJlcjtcclxuICAgICAgICAgIHN0cmVldE5hbWUuaW5uZXJIVE1MID0gYERpc3BsYXlpbmcgcmVzdWx0cyBmb3IgJHtzdG9wTmFtZX1gO1xyXG4gICAgICAgICAgcm91dGVzW1wic2NoZWR1bGVkLXN0b3BzXCJdLmZvckVhY2goKHJvdXRlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCB0aW1lVG9Db252ZXJ0ID0gbmV3IERhdGUocm91dGUudGltZXMuYXJyaXZhbC5lc3RpbWF0ZWQpO1xyXG4gICAgICAgICAgICBsZXQgdGltZSA9IHRpbWVUb0NvbnZlcnQudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJywgeyBob3VyOiAnbnVtZXJpYycsIG1pbnV0ZTogJ251bWVyaWMnLCBob3VyMTI6IHRydWUgfSk7XHJcbiAgICAgICAgICAgIGluc2VydEhUTUxGb3JFYWNoU3RvcHMoc3RvcE5hbWUsIGRpcmVjdGlvbiwgY3Jvc3NTdHJlZXQsIGJ1c051bWJlciwgdGltZSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gaW5zZXJ0SFRNTEZvckVhY2hTdG9wcyhuYW1lLCBkaXJlY3Rpb24sIGNyb3NzU3RyZWV0LCBidXNOdW1iZXIsIHRpbWUpIHtcclxuICB0Ym9keS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsXHJcbiAgYDx0cj5cclxuICA8dGQ+JHtuYW1lfTwvdGQ+XHJcbiAgPHRkPiR7Y3Jvc3NTdHJlZXR9PC90ZD5cclxuICA8dGQ+JHtkaXJlY3Rpb259PC90ZD5cclxuICA8dGQ+JHtidXNOdW1iZXJ9PC90ZD5cclxuICA8dGQ+JHt0aW1lfTwvdGQ+XHJcbiAgPC90cj5cclxuICBgKVxyXG59O1xyXG4iXX0=
